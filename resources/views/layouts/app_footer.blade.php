<!-- Load CSS Styles -->
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/menu.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/ace-responsive-menu.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/megadropdown.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/bootstrap-select.min.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/simplebar.min.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/progressbar.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/flaticon.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/animate.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/slider.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/magnific-popup.css') }}">
<link type="text/css"  rel="stylesheet" href="{{ asset('web/css/timecounter.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.css" integrity="sha512-lvdq1fIyCp6HMWx1SVzXvGC4jqlX3e7Xm7aCBrhj5F1WdWoLe0dBzU0Sy10sheZYSkJpJcboMNO/4Qz1nJNxfA==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<!-- Load CSS Styles -->

<!-- Wrapper End -->
<script type="text/javascript" src="{{ asset('web') }}/js/popper.min.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/bootstrap.min.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/jquery.mmenu.all.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/ace-responsive-menu.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/bootstrap-select.min.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/snackbar.min.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/simplebar.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/parallax.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/scrollto.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/jquery-scrolltofixed-min.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/jquery.counterup.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/wow.min.js"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/slider.js"></script>
{{-- <script type="text/javascript" src="{{ asset('web') }}/js/pricing-slider.js"></script> --}}
<script type="text/javascript" src="{{ asset('web') }}/js/timepicker.js"></script>

<!-- Custom script for all pages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js" integrity="sha512-IsNh5E3eYy3tr/JiX2Yx4vsCujtkhwl7SLqgnwLNgf04Hrt9BT9SXlLlZlWx+OK4ndzAoALhsMNcCmkggjZB1w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript" src="{{ asset('web') }}/js/scripts.js"></script>

{{-- <script src='https://maps.google.com/maps/api/js?key=AIzaSyDdH9T5u9n-sAM3_mK8C1Ne8LwMysAhW4o&libraries=places'></script> --}}
{{-- <!-- Wrapper End -->
<script type="text/javascript" src="{{ asset('website/js/jquery-migrate-3.0.0.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/popper.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/bootstrap.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/jquery.mmenu.all.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/ace-responsive-menu.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/chart.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/chart-custome.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/bootstrap-select.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/isotop.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/snackbar.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/simplebar.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/parallax.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/scrollto.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/jquery-scrolltofixed-min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/jquery.counterup.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/wow.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/progressbar.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/slider.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/timepicker.js') }}"></script>
<script type="text/javascript" src="{{ asset('website/js/wow.min.js') }}"></script>
<!-- Custom script for all pages -->
<script type="text/javascript" src="{{ asset('website/js/script.js') }}"></script>

<script type="text/javascript" src="{{ asset('website/js/jquery.steps.min.js') }}"></script>
<!-- Custom script for all pages -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.3/css/intlTelInput.min.css" />
<script type="text/javascript" src="{{asset('website/js/script.js')}}"></script>
 --}}

<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.3/js/intlTelInput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.3/js/utils.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.min.js" defer></script>
<script>
   $(document).ready(function(){
   /**Start Search Filter Script*/
       $('.select2_el').select2();
       $('input[name="t"]').change(function(){
           getPropertyTypes($(this).val());
       });

       const search = '';
               $.ajax({
                   url:"{{ route('search-locations') }}",
                   metod:"GET",
                   data:{search},
                   success:function(res){
                       $('#l').html(res);
                   },error:function(xhr){
                       console.log(xhr.responseText);
                   }
               });

       getPropertyTypes(1);
       function getPropertyTypes(type){
           $.ajax({
               url: "{{ route('get-property-categories') }}",
               method:"POST",
               data:{type, _token: "{{ csrf_token() }}"},
               success:function(res)
               {
                   const data = JSON.parse(res);
                   $('#c').html(data.categories);
                   $('#mnp').html(data.mnp);
                   $('#mxp').html(data.mxp);
                   $('#mnz').html(data.mnz);
                   $('#mxz').html(data.mxz);
               },
               error:function(xhr)
               {
                   console.log(xhr.responseText);
               }
           });
       }

       /**End Search Filter Script*/

       /**Start Sign Up and Login Scripts*/
       $('#resend_verification_code').click(function(){
        const phone = $('#verification_phone').val();
        $.ajax({
                url: "{{ route('auth.resend_verification_code') }}",
                type: "POST",
                data: {phone, _token:"{{ @csrf_token() }}"},
                success: function(res) {
                    if(res == 'true')
                    {
                        $('#verification_code_success').html("Verification Code Sent Successfully");
                    }
                    else if(res == "false"){
                        return $('#verification_code_error').html('This code doesn\'t match with our records.');
                    }
                },error:function(xhr){
                    console.log(xhr.responseText);
                }
        });
    });

    $('#verify_code').click(function(){
        const vc_1 = $('input[name="vc_1"]').val();
        const vc_2 = $('input[name="vc_2"]').val();
        const vc_3 = $('input[name="vc_3"]').val();
        const vc_4 = $('input[name="vc_4"]').val();
        const data = $('#verify-phone').serialize();
        $('#verification_code_success').html("");
        if(vc_1 == "" || vc_2 == "" || vc_3 == "" || vc_4 == ""){
          return $('#verification_code_error').html('Please enter verification code');
        }
        else {
            $('#verification_code_error').html('');
            $.ajax({
                url: "{{ route('auth.veirfy_code') }}",
                type: "POST",
                data: $('#verify-phone').serialize(),
                success: function(res) {
                    if(res == 'true')
                    {
                        $('#verify-phone').attr('class', 'd-none');
                        $('#sinupForm').removeAttr('class', 'd-none');
                        $('#profile-tab').attr('class', 'nav-link');
                        $('#profile').attr('class', 'row mt25 tab-pane fade');
                        $('#home-tab').attr('class', 'nav-link active ');
                        $('#home').attr('class', 'row mt25 tab-pane fade active show');

                    }
                    else if(res == "false"){
                        return $('#verification_code_error').html('This code doesn\'t match with our records.');
                    }
                },error:function(xhr){
                    console.log(xhr.responseText);
                }
            });
        }
    });


    $("#loginForm").validate({
        rules: {
            login_email: {
                required: true,
                email: true
            },
            login_password: {
                required: true
            },
        },
        messages:{
            login_email:{
                required: "The email field is required.",
            },
            login_password:{
                required: "The password field is required.",
            },
        },
            submitHandler: function(form) {
            $.ajax({
                url: "{{ route('auth.login') }}",
                type: "POST",
                data: $('#loginForm').serialize(),
                success: function(res) {
                    if(res === "true")
                    {
                        window.location.reload();
                    }
                    else if(res == 'false'){
                        $('#login_error').html('Invalid Email or Password');
                    }else if(res == 'deactive'){
                        $('#login_error').html('Your account is deactive. Please contect with support!');
                    }
                },error:function(xhr){
                    console.log(xhr.responseText);
                }
            });
        }
        });

    $("#sinupForm").validate({
        rules: {
            username : {
                required: true,
                minlength: 3
            },
            email: {
                required: true,
                email: true
            },
			phone: {
                required: true,
                minlength: 9
            },
            password: {
                required: true,
                minlength: 6
            },
            password_confirm : {
                required:true,
                minlength : 6,
                equalTo : '[name="password"]'
            },
            termsConditions : "required"
        },
        messages:{
            username:{
                required: "The full name field is required.",
                minlength: "Full name length should be atleast 3 characters."
            },
            email:{
                required: "The email field is required.",
            },
			phone:{
                required: "The phone field is required.",
                minlength: "Phone length must be atleast 9 digits."
            },
            password:{
                required: "The password field is required.",
                minlength: "Password length should be atleast 6 characters."
            },
            password:{
                required: "The password field is required.",
                minlength: "Password length should be atleast 6 characters."
            },
            password_confirm:{
                required: "The confirm password field is required.",
                equalTo: "Passwords not matched."
            },
            termsConditions:{
                required: "Please confirm!",
            }
        },
            submitHandler: function(form) {
            $.ajax({
                url: "{{ route('auth.signup') }}",
                type: "POST",
                data: $('#sinupForm').serialize(),
                beforeSend:function(){
                    $('#sinupForm button[type="submit"]').attr('disabled');
                    $('#sinupForm button[type="submit"]').html('Submit');
                },
                success: function(res) {
                    // return console.log(res)
                    $('#sinupForm button[type="submit"]').removeAttr('disabled');
                    $('#sinupForm button[type="submit"]').html('Submit');
                    if(res === "email")
                    {
                        $('#email_error').html('Email already taken.');
                        return $('input[name="email"]').focus();
                    }
                    else if(res == "phone"){
                        $('#email_error').html('Phone already taken.');
                        return $('input[name="phone"]').focus();
                    }else{
                        $('#verify-phone').removeAttr('class');
                        $('#sinupForm').attr('class', 'd-none');
                        $('#verification_phone').val(res);
                        $('#sinupForm')[0].reset();
                    }
                },error:function(xhr){
                    console.log(xhr.responseText);
                }
            });
        }
        });
       /**Start Sign Up and Login Scripts*/
   });


</script>
<script>
    jQuery(function($) {
    'use strict';

    var body = $('#verify-phone');

    function goToNextInput(e) {
        var key = e.which,
        t = $(e.target),
        sib = t.next('input');
        const atClass = t.attr('class');

        if (key != 9 && (key < 48 || key > 57)) {
        e.preventDefault();
        return false;
        }

        if (key === 9) {
        return true;
        }

        if (!sib || !sib.length) {
        if(atClass != 'last-one')
        {
            sib = body.find('input').eq(0);
        }
        }
        sib.select().focus();
    }

    function onKeyDown(e) {
        var key = e.which;

        if (key === 9 || (key >= 48 && key <= 57)) {
        return true;
        }

        e.preventDefault();
        return false;
    }

    function onFocus(e) {
        $(e.target).select();
    }

    body.on('keyup', 'input', goToNextInput);
    body.on('keydown', 'input', onKeyDown);
    body.on('click', 'input', onFocus);

    })

    $(document).ready(function($){
        $(".typesList .viewall").on("click", function(){
        if($(".typesList ul").height()==30){
        var txt = $('.typesList ul').height()==30 ? 'View Less Locations' : '';
        // alert(txt);
        $('.typesList .viewall').text(txt);
        $('.typesList ul').css('height','auto');
        }else{
                    var txt = $('.typesList .viewall').height()!=30 ? 'View All Locations' : '';
        $('.typesList .viewall').text(txt);
        $('.typesList ul').css('height','30');
        }
        });
        //Select 2 For Search Option
        $(".input-search").select2({
            placeholder: "Location"
        });

        /**Adding Favourite Property*/
        $(`body`).delegate(`#fav_prop`, `click`, function(){
             const property_id = $(this).attr('data-id')
             const user_id = $(`#auth_user_id`).val();

             /**If User is Not Login Then Show Login Form*/
             if(user_id === ""){
                 $(`#open-modal-btn`).trigger('click');
             }
             else{
                 $.ajax({
                     url:"{{ route('add-property-to-favourite') }}",
                     method:"POST",
                     data:{property_id,_token:"{{ csrf_token() }}"},
                     success:function(res){
                         if(res == 'true'){
                             alert('Property Added To Favourite Successfully!');
                         }
                         else
                         {
                            alert('Property Already Added To Favourite!');
                         }
                     },error:function(xhr){
                         console.log(xhr.responseText)
                     }
                 });
             }
        });

    });
</script>
